"use strict";var z=Object.create;var p=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var M=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var I=(t,n)=>{for(var i in n)p(t,i,{get:n[i],enumerable:!0})},m=(t,n,i,a)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of E(n))!C.call(t,o)&&o!==i&&p(t,o,{get:()=>n[o],enumerable:!(a=A(n,o))||a.enumerable});return t};var d=(t,n,i)=>(i=t!=null?z(M(t)):{},m(n||!t||!t.__esModule?p(i,"default",{value:t,enumerable:!0}):i,t)),N=t=>m(p({},"__esModule",{value:!0}),t);var b={};I(b,{Py:()=>e});module.exports=N(b);var h=d(require("node:path"),1),r=d(require("node:fs"),1),P=require("node:child_process"),[u,l,y]=function(){if(w())return["venv","python.exe","python"];if(x())return["venv","python3","python3"];if(S())return["venv","python3","python3"];throw new Error(`${process.platform} has not been supported.`)}();function w(){return process.platform==="win32"}function x(){return process.platform==="darwin"}function S(){return process.platform==="linux"}function f(...t){return new Promise(function(n,i){let a="",o="",c=(0,P.spawn)(t.shift(),t);c.stdout.on("data",function(s){a+=s.toString()}),c.stderr.on("data",function(s){o+=s.toString()}),c.on("error",function(s){i(s)}),c.on("exit",function(s,j){n({stdout:a,stderr:o})})})}function v(t){r.default.existsSync(t)||r.default.mkdirSync(t,{recursive:!0})}function g(t){r.default.existsSync(t)&&r.default.rmSync(t,{recursive:!0})}var e=class{constructor(n){this.installationPath=n||".",this.venvPath=h.default.join(this.installationPath,u),w()?this.pythonPath=h.default.join(this.installationPath,u,"Scripts",l):x()?this.pythonPath=h.default.join(this.installationPath,u,"bin",l):S()&&(this.pythonPath=h.default.join(this.installationPath,u,"bin",l))}};e.prototype.getPythonCommand=function(){return this.inInitialized()?this.pythonPath:y};e.prototype.inInitialized=function(){return r.default.existsSync(this.installationPath)&&r.default.existsSync(this.venvPath)&&r.default.existsSync(this.pythonPath)};e.prototype.init=async function(t){if(!y)throw new Error(`${process.platform} has not been supported.`);if(!this.inInitialized()&&(v(this.installationPath),t&&g(this.venvPath),v(this.venvPath),await f(y,"-m","venv",this.venvPath),!this.inInitialized()))throw new Error("Could not create venv.");return this};e.prototype.destory=async function(){return g(this.venvPath),this};e.prototype.freeze=async function(){return await f(this.getPythonCommand(),"-m","pip","freeze")};e.prototype.getModules=async function(){let{stdout:t,stderr:n}=await this.freeze();return t.replace(/\r\n/g,`
`).replace(/\n$/,"").split(/\n/).map(function(i){return{name:i.split("==")[0],version:i.split("==")[1]}})};e.prototype.isInstalled=async function(t){let n=await this.getModules();for(let i of n)if(i.name.indexOf(t)===0)return!0;return!1};e.prototype.install=async function(t,n){return await f(this.getPythonCommand(),"-m","pip","install",t,...Array.isArray(n)?n:[])};e.prototype.exec=async function(t,n){return await f(this.getPythonCommand(),t,...Array.isArray(n)?n:[])};0&&(module.exports={Py});
